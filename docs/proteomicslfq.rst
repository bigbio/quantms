ProteomicsLFQ metatool (OpenMS)
===============================

The ProteomicsLFQ tool performs label-free quantification of peptides and proteins.

**Feature extraction:**
ProteomicsLFQ supports **ID-based feature extraction** or a combined **ID-based + untargeted extraction**.

1. **ID-based feature extraction** uses targeted feature detection using RT and m/z information derived from identification data to extract features. Only identifications found in a particular MS run are used to extract features in the same run. No transfer of IDs (match between runs) is performed.
2. **ID-based + untargeted extraction** adds untargeted feature detection to obtain quantities from unidentified features. Transfer of IDs (match between runs) is performed by transfering feature identifications to coeluting, unidentified features with similar mass and RT in other runs.
         
**Requantification:**
1. Optionally, a requantification step is performed that tries to fill missing values. If a peptide has been quantified in more than half of all maps, the peptide is selected for requantification. In that case, the mean observed RT (and theoretical m/z) of the peptide is used to perform a second round of targeted extraction.

**Map alignment:**
ProteomicsLFQ supports two modes of alignment. **star** alignment and **tree guided** alignment.
1. **star** alignment uses the MapAlignmentAlgorithmIdentification algorithm to align all data to the reference run with the highest number of identifications.
2. **tree guided** alignment uses the MapAlignmentAlgorithmIdentification algorithm to align data. For each pair of maps, the similarity is determined based on the intersection of the contained identifications using Pearson correlation. Using hierarchical clustering together with average linkage a binary tree is produced. Following the tree, the maps are aligned, resulting in a transformed data.

Cubic spline smoothing is used to convert the mapping to a smooth function.

**Feature linking:**
Features are linked using the OpenMS FeatureGroupingAlgorithmQT with a maximum linking tolerance of 10 ppm and RT tolerance estimated from the data.

**Input (automatically generated by workflow):**
1. Spectra in mzML format
2. Filtered (1% FDR, q-value < 0.01) identifications in idXML or mzIdentML format with posterior error probabilities as score type.

**Output:**

1. mzTab file with analysis results
2. Analysis results for statistical downstream analysis in MSstats and Triqler
3. ConsensusXML file for visualization and further processing in OpenMS
